# åç«¯-åŸºç¡€æ­å»º

[toc]

## 1ã€ğŸ‰ é¡¹ç›®åŸºç¡€ç›®å½•ç»“æ„ç»„ç»‡

### 1-1ã€åˆå§‹åŒ–

åˆ›å»ºé¡¹ç›®ç›®å½• `backend`ï¼Œå¹¶é€šè¿‡ `npm init` è¿›è¡Œåˆå§‹åŒ–ã€‚

### 1-2ã€ts é…ç½®

æ ¹ç›®å½•åˆ›å»º ts é…ç½®æ–‡ä»¶ï¼š`tsconfig.json`ï¼Œé…ç½®å¦‚ä¸‹ï¼š

```json
// file: backend/tsconfig.json
{
    "compilerOptions": {
        "allowJs": true,
        "outDir": "./dist",
        "module": "commonjs",
        "target": "es2016",
        "sourceMap": true,
        "noImplicitAny": true,
        "strictNullChecks": true,
        "experimentalDecorators": true,
        "emitDecoratorMetadata": true,
        "resolveJsonModule": true,
        "esModuleInterop": true,
        "allowSyntheticDefaultImports": true
    },
    "include": [
        "./src/**/*"
    ]
}
```

### 1-3ã€åˆ›å»ºæºç ç›®å½•

æ ¹ç›®å½•ä¸‹åˆ›å»º `src` ç›®å½•ï¼Œä½œä¸ºæˆ‘ä»¬çš„æºç å­˜æ”¾ç›®å½•ã€‚

### 1-4ã€åˆ›å»ºé¡¹ç›®ä¸»å…¥å£æ–‡ä»¶

`src` ç›®å½•ä¸‹åˆ›å»ºé¡¹ç›®å¯åŠ¨å…¥å£æ–‡ä»¶ï¼š`app.ts`ã€‚

### 1-5ã€åˆ›å»ºé¡¹ç›®é…ç½®æ–‡ä»¶ç›®å½•åŠæ–‡ä»¶

é¡¹ç›®ä¸­ä¼šç”¨åˆ°è®¸å¤šçš„ä¸€äº›åŠ¨æ€å¯å˜æ•°æ®ï¼Œæ¯”å¦‚ä¸åŒç¯å¢ƒä¸‹ï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿæˆç­‰ï¼‰ä¸»æœºåœ°å€ï¼Œç«¯å£ï¼Œæ•°æ®åº“è¿æ¥ä¿¡æ¯ç­‰ã€‚æˆ‘ä»¬åœ¨ `src` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `configs` ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š`index.ts` ï¼Œå…ˆå†™å…¥ä»¥ä¸‹åŸºæœ¬ä¿¡æ¯ï¼Œåç»­ä¼šæ ¹æ®éœ€æ±‚å†è¿›è¡Œå¢åŠ ï¼š

```typescript
// file: backend/src/configs/index.ts
const configs = {
    development: {
        server: {
            host: 'localhost',
            port: 8080
        }
    },
    test: {
        server: {
            host: 'localhost',
            port: 8080
        }
    },
    production: {
        server: {
            host: 'localhost',
            port: 8080
        }
    }
}

type configs = typeof configs;
type configKeys = keyof configs;

const NODE_ENV = process.env.NODE_ENV as configKeys || 'development';

export default configs[NODE_ENV];
```

### 1-6ã€ç±»å‹å£°æ˜æ–‡ä»¶

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`TypeScript` æ²¡æœ‰å†…ç½® `node` ç›¸å…³çš„ç±»å‹å£°æ˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å®‰è£…ï¼š

```shell
npm i -D @types/node
```



## 2ã€ğŸ“ å…¥å£æ–‡ä»¶

### 2-1ã€å®‰è£… Koa

```shell
npm i koa
```

### 2-2ã€å®‰è£… Koa ç±»å‹å£°æ˜æ–‡ä»¶

å› ä¸º `Koa` å¹¶ä¸æ˜¯ `TS` ç¼–å†™çš„ï¼Œä¸”å®˜æ–¹åŒ…ä¸­ä¹Ÿæ²¡æœ‰æä¾›å¯¹åº”çš„ç±»å‹å£°æ˜æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å•ç‹¬å®‰è£…

```shell
npm i -D @types/koa
```

### 2-3ã€ç¼–å†™åŸºæœ¬ä»£ç 

```typescript
// file: backend/src/app.ts
import configs from './configs';
import Koa from 'koa';

const app = new Koa();

app.listen(configs.server.port, configs.server.host, () => {
		console.log(`æœåŠ¡å¯åŠ¨æˆåŠŸï¼š http://${configs.server.host}:${configs.server.port}`);
});
```



## 3ã€ğŸŠ åº”ç”¨å¯åŠ¨

åœ¨å¼€å‘é˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `ts-node-dev` å·¥å…·æ¥ç›´æ¥å¸®åŠ©æˆ‘ä»¬ç¼–è¯‘å¹¶è¿è¡Œ `ts` æ–‡ä»¶ï¼ŒåŒæ—¶å®ƒè¿˜æœ‰çƒ­é‡å¯çš„åŠŸèƒ½ã€‚

### 3-1ã€å®‰è£…

```shell
npm i -D ts-node-dev
// åŒæ—¶å› ä¸º ts-node-dev éœ€è¦ç¼–è¯‘tsï¼Œæ‰€ä»¥è¿˜éœ€è¦å®‰è£… typescript
npm i -D typescript
```

### 3-2ã€é…ç½®å¯åŠ¨

```json
// file: backend/package.json

{
  	//...,
  	"scripts": {
    		//...,
      	"dev": "ts-node-dev ./src/app.ts"
  	},
  	//...
}
```

### 3-3ã€å¯åŠ¨

```shell
npm run dev
```



## 4ã€ğŸ‡ koa-ts-controllers

æˆ‘ä»¬çš„é¡¹ç›®ä½¿ç”¨çš„æ˜¯ `TypeScript` è¿›è¡Œçš„å¼€å‘ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œå°±å°½é‡å»å¸¦å¤§å®¶äº†è§£ä¸€ä¸‹å„ç§æŠ€æœ¯åœ¨å¼€å‘ä¸­çš„ä½¿ç”¨ä¸æŠ€å·§ã€‚

æ¯”å¦‚è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ªåŸºäº `TypeScript` çš„è·¯ç”±æ§åˆ¶æ¡†æ¶ï¼š`koa-ts-controllers`ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥äº†è§£ä¸€ä¸‹å®ƒçš„ä½¿ç”¨ï¼

