# åç«¯-ä½¿ç”¨postmanè¿›è¡Œæ¥å£æµ‹è¯•

[toc]

## 1ã€ğŸ‰ ä»€ä¹ˆæ˜¯ Postman

`Postman` æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„æ¥å£è°ƒè¯•å·¥å…·ã€‚



## 2ã€ğŸ“ å®‰è£…

å®˜ç½‘ï¼šhttps://www.postman.com/



## 3ã€ğŸŠ åˆ›å»ºé›†åˆ

`é›†åˆ` æ˜¯ `Postman` å¯¹è¯·æ±‚è¿›è¡Œç»„ç»‡çš„ä¸€ç§æ–¹å¼ï¼Œæ–¹ä¾¿ç®¡ç†å’Œç»´æŠ¤ã€‚



## 4ã€ğŸ‡ è®¾ç½®é›†åˆå˜é‡

æˆ‘ä»¬å¯ä»¥ç»™é›†åˆè®¾ç½®ä¸€äº›å˜é‡ï¼Œåœ¨è¯·æ±‚ä¸­è¿›è¡Œå¤ç”¨ã€‚

### 4-1ã€æ·»åŠ  baseUrl å˜é‡

åœ¨é›†åˆå˜é‡ä¸­æ·»åŠ  `baseUrl` ï¼Œå€¼ä¸ºï¼š`http://localhost:8080/api/v1`



## 5ã€ğŸ… æ·»åŠ è¯·æ±‚

æ¯ä¸€ä¸ªè¯·æ±‚å°±æ˜¯æˆ‘ä»¬å¯¹ `api` çš„ä¸€æ¬¡è°ƒç”¨åŠæµ‹è¯•ã€‚

### Get

### Post

### Params

### Headers

### Body

###  å“åº”

### 5-1ã€åœ¨è¯·æ±‚ä¸­ä½¿ç”¨é›†åˆå˜é‡

åœ¨è¯·æ±‚çš„ä¸€äº›é…ç½®ï¼ˆå‚æ•°ï¼‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `{{baseUrl}}` æ¥è°ƒç”¨æˆ‘ä»¬åœ¨ä¸Šé¢é›†åˆé…ç½®ä¸­è®¾ç½®çš„å˜é‡ã€‚

### 5-2ã€å…¶å®ƒè®¾ç½®

- è¯·æ±‚æ–¹æ³•è®¾ç½®
- `Params` è®¾ç½®ï¼Œè¿™é‡Œçš„ `Params` æŒ‡çš„æ˜¯ `queryString`
- è¯·æ±‚å¤´è®¾ç½®
- è¯·æ±‚æ­£æ–‡
  - æ­£æ–‡æ ¼å¼

### 5-3ã€å“åº”ä¿¡æ¯

- å“åº”æ­£æ–‡
- å“åº”å¤´
- çŠ¶æ€ç 
- è¯·æ±‚æ—¥å¿—

### 5-4ã€postman å†…ç½®æ•°æ®ç”Ÿæˆå™¨

`postman` å†…ç½®æä¾›äº†è®¸å¤šçš„éšæœºæ•°æ®ç”Ÿæˆå™¨ï¼Œå¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆå„ç§æ•°æ®ã€‚

https://learning.postman.com/docs/postman/scripts/postman-sandbox-api-reference/#dynamic-variables



## 6ã€ğŸ‘ ä½¿ç”¨æ–‡ä»¶å¤¹ç»„ç»‡è¯·æ±‚

æˆ‘ä»¬å¯ä»¥æ ¹æ®è¯·æ±‚çš„ç±»å‹ï¼ŒæŠŠä»–ä»¬é€šè¿‡æ–‡ä»¶å¤¹çš„å½¢å¼æœ‰åºçš„è¿›è¡Œç»„ç»‡ã€‚



## 7ã€ğŸ æ·»åŠ æˆæƒ

åœ¨æˆ‘ä»¬çš„åç»­çš„åº”ç”¨ä¸­ï¼Œè®¸å¤šçš„æ¥å£æ˜¯éœ€è¦ç™»å½•æˆæƒåæ‰èƒ½è®¿é—®çš„ã€‚æˆ‘ä»¬æ‰€ä½¿ç”¨çš„éªŒè¯æ–¹å¼æ˜¯ `JWT` ï¼ŒåŒæ—¶æˆ‘ä»¬æ˜¯åŸºäº `Header` æ¥å¯¹æˆæƒ `token` è¿›è¡Œä¼ è¾“çš„ã€‚æ ¹æ®ä»¥ä¸Šè§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `Postman` ä¸­å¯¹è¿™ç§æˆæƒæ–¹å¼è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚



## 8ã€ğŸŒ æ·»åŠ æ–­è¨€æµ‹è¯•è„šæœ¬

æˆ‘ä»¬å¯ä»¥ç»™æ¯ä¸ªæ¥å£è¯·æ±‚æ·»åŠ æ–­è¨€æµ‹è¯•è„šæœ¬ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬å¯¹æ¥å£å“åº”è¿›è¡Œæµ‹è¯•åé¦ˆï¼Œå‡è½»äººåŠ›ã€‚

`Postman` æä¾›äº†ä¸€ä¸ªå†…ç½®å¯¹è±¡ `pm` ã€‚é€šè¿‡è¯¥å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€è¯·æ±‚ï¼Œæ–­è¨€æµ‹è¯•ä¹Ÿæ˜¯é€šè¿‡å®ƒæ¥å®Œæˆã€‚ä¸‹é¢ä»‹ç»å‡ ä¸ªæˆ‘ä»¬è¿™é‡Œä¼šç”¨åˆ°çš„å‡ ä¸ª `API`ï¼š

### Collection æ“ä½œ

#### è®¾ç½®é›†åˆå˜é‡

```js
pm.collectionVariables.set(variableName:String, variableValue:String);
```

#### è·å–é›†åˆå˜é‡

```js
pm.collectionVariables.get(variableName:String);
```

#### æ¸…é™¤é›†åˆå˜é‡

```
pm.collectionVariables.unset(variableName:String);
```

### æ–­è¨€æµ‹è¯•

```js
pm.test('æè¿°', function() {
  	//æ–­è¨€
  	pm.expect(true).to.be.true;
});
```

#### å“åº”å†…å®¹æ˜¯å¦åŒ…å«æŸä¸ªå­—ç¬¦ä¸²

```js
pm.test("å†…å®¹åŒ…å«kkb", function () {
		pm.expect(pm.response.text()).to.include("kkb");
});
```

#### å“åº”å†…å®¹æ˜¯å¦ç­‰äºæŸä¸ªå­—ç¬¦ä¸²

```js
pm.test("å†…å®¹ç­‰äºkkb", function () {
    pm.response.to.have.body("kkb");
});
```

#### æ£€æµ‹å¤´ä¿¡æ¯æ˜¯å¦å­˜åœ¨æŒ‡å®šå¤´

```js
pm.test("å­˜åœ¨content-type", function () {
    pm.response.to.have.header("Content-Type");
});
```

#### å“åº”æ—¶é—´å°äºæŒ‡å®šå€¼

```js
pm.test("å“åº”å°äº200ms", function () {
    pm.expect(pm.response.responseTime).to.be.below(200);
});
```

#### æ£€æµ‹çŠ¶æ€ç æ˜¯å¦æ˜¯200

```js
pm.test("çŠ¶æ€ç ä¸º200", function () {
    pm.response.to.have.status(200);
});
```

#### çŠ¶æ€æ–‡æœ¬æ˜¯å¦åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²

```js
pm.test("çŠ¶æ€æ–‡æœ¬åŒ…å«Created", function () {
    pm.response.to.have.status("Created");
});
```

#### çŠ¶æ€ç æ˜¯å¦ä¸ºæŒ‡å®šçš„å€¼ä¹‹ä¸€

```js
pm.test("æˆåŠŸ", function () {
    pm.expect(pm.response.code).to.be.oneOf([201,202]);
});
```

#### ä½¿ç”¨ `ajv` åº“è¿›è¡Œ `JSON Schema` æ ¼å¼éªŒè¯

##### ä»€ä¹ˆæ˜¯ `JSON Schema`ï¼Ÿ

`JSON Schema` å®šä¹‰äº†ä¸€å¥—è¯æ±‡å’Œè§„åˆ™ï¼Œè¿™å¥—è¯æ±‡å’Œè§„åˆ™ç”¨æ¥å®šä¹‰ `JSON` å…ƒæ•°æ®ï¼Œä¸”å…ƒæ•°æ®ä¹Ÿæ˜¯é€šè¿‡ `JSON` æ•°æ®å½¢å¼è¡¨è¾¾çš„ã€‚`JSON` å…ƒæ•°æ®å®šä¹‰äº† `JSON` æ•°æ®éœ€è¦æ»¡è¶³çš„è§„èŒƒï¼Œè§„èŒƒåŒ…æ‹¬æˆå‘˜ã€ç»“æ„ã€ç±»å‹ã€çº¦æŸç­‰ã€‚ä½¿ç”¨å®ƒæˆ‘ä»¬å°±å¯ä»¥å¯¹ `JSON` æ•°æ®è¿›è¡Œåˆæ³•æ€§æ ¡éªŒã€‚

å‚è€ƒï¼šhttp://json-schema.org/draft/2019-09/json-schema-validation.html

```js
const Ajv = require('ajv');
const ajv = new Ajv({logger: console});
const schema = {
  	required: ["id","name", "createAt"],
		properties: {
    		id: {
      			type: "number"
    		},
      	name: {
          	type: "string"
        },
      	createAt: {
          	type: "string",
          	format: "date-time"
        }
  	}
};

pm.test('Schema is valid', function() {
    pm.expect(ajv.validate(schema, {
      "id": 5,
    	"name": "Aryanna",
    	"createAt": "2020-03-27T16:00:47.464Z"
    })).to.be.true;
});
```

`Postman` å†…ç½®å®‰è£…äº†è®¸å¤šçš„ä¸€äº›å¸¸ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚ä¸Šé¢çš„ `ajv` ï¼Œè¿˜åŒ…æ‹¬ï¼š

- [ajv](https://www.npmjs.com/package/ajv) â†’ v6.6.2
- [atob](https://www.npmjs.com/package/atob) â†’ v2.1.2
- [btoa](https://www.npmjs.com/package/btoa) â†’ v1.2.1
- [chai](http://chaijs.com/) â†’ v4.2.0
- [cheerio](https://cheerio.js.org/) â†’ v0.22.0
- [crypto-js](https://www.npmjs.com/package/crypto-js) â†’ v3.1.9-1
- [csv-parse/lib/sync](http://csv.adaltas.com/parse) â†’ v1.2.4
- [lodash](https://lodash.com/) â†’ v4.17.11 (when used with require, the inbuilt `_` object is for v3.10.1)
- [moment](http://momentjs.com/docs/) â†’ v2.22.2 (sans locales)
- [postman-collection](http://www.postmanlabs.com/postman-collection/) â†’ v3.4.0
- [tv4](https://github.com/geraintluff/tv4) â†’ v1.3.0
- [uuid](https://www.npmjs.com/package/uuid) â†’ (the module loaded is a shim for original module)
- [xml2js](https://www.npmjs.com/package/xml2js) â†’ v0.4.19

è¿˜æœ‰ä¸€äº› `NodeJS` æ¨¡å—

[
path](https://nodejs.org/api/path.html)

[assert](https://nodejs.org/api/assert.html)

[buffer](https://nodejs.org/api/buffer.html)

[util](https://nodejs.org/api/util.html)

[url](https://nodejs.org/api/url.html)

[punycode](https://nodejs.org/api/punycode.html)

[querystring](https://nodejs.org/api/querystring.html)

[string-decoder](https://nodejs.org/api/string_decoder.html)

[stream](https://nodejs.org/api/stream.html)

[timers](https://nodejs.org/api/timers.html)

[events](https://nodejs.org/api/events.html)

##### æ–­è¨€åº“

https://www.chaijs.com/api/



## 9ã€ğŸ è‡ªåŠ¨åŒ–æµ‹è¯•

æˆ‘ä»¬ä¸ä»…ä»…å¯ä»¥å¯¹å•ä¸ªçš„è¯·æ±‚è¿›è¡Œæµ‹è¯•ï¼Œè¿˜å¯ä»¥å¯¹æ–‡ä»¶å¤¹ï¼Œæ•´ä¸ªé›†åˆè¿›è¡Œæ‰¹é‡çš„æµ‹è¯•ï¼Œæé«˜æ•ˆç‡ã€‚



## 10ã€ğŸ’ Postman è„šæœ¬çš„å¯¼å‡ºä¸å¯¼å…¥

æœ€åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠè¯·æ±‚æµ‹è¯•è¿›è¡Œå¯¼å‡ºå’Œå¯¼å…¥ã€‚